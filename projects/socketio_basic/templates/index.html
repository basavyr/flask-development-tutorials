{% extends "base.html" %} {% block title %}Index{% endblock %} {% block body %}
<h1>This is the index page</h1>

<p>The index page was generated at {{time}}.</p>

<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script type="text/javascript">
  $(document).ready(function () {
    var socket = io();

    let x = 0;

    socket.on("connect", function (data) {
      socket.send("User has connected!");
      //test the connection event by sending messages on three different channels
      socket.emit("channel1", "User has connected!");
      socket.emit("channel2", "User has connected!");
      socket.emit("channel3", "User has connected!");
    });

    socket.on("message", function (msg) {
      $("#messages").append("<li>" + msg["data"] + "</li>");
      socket.emit("channel2", "some content was submitted");
      //   console.log("This is from the server: " + msg);
    });

    socket.on("channel2 response", function (msg) {
      $("#texts").append("<p>" + x + "->" + msg + "</p>");
      console.log("This is from the server: " + msg);
      x = x + 1;
    });

    socket.on("connection_response", function (msg) {
      console.log(
        "Connection response from the server: " +
          msg["message"] +
          " at " +
          msg["time"]
      );
    });

    $("#button").on("click", function () {
      socket.send($("#myMessage").val());
      $("#myMessage").val("");
    });
  });
</script>
<ul id="messages"></ul>
<input type="text" id="myMessage" />
<button id="button">Send</button>
<div id="texts"></div>

<script
  src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"
  integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA=="
  crossorigin="anonymous"
></script>
<script type="text/javascript" charset="utf-8">
  var socket = io();
  socket.on("connect", function () {
    console.log("Connection established!");
    socket.emit("my_connection_event", { data: "I'm connected!" });
  });
  //   socket.on("message", function (data) {
  //     console.log(data);
  //   });
</script>
<script src="static/js/application.js"></script>

{% endblock %}
